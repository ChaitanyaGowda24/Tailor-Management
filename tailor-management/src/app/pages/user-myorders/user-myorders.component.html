<div class="dashboard-container">
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <h1>My Orders Dashboard</h1>
  </div>

  <!-- Dashboard Cards -->
  <div class="dashboard-cards">
    <div class="card">
      <h3>Total Orders Placed</h3>
      <p>{{ totalOrders }}</p>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <div class="chart-card">
      <h3>Orders by Status</h3>
      <div class="chart-container">
        <canvas id="statusChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <h2>Filter Orders</h2>
    <div class="filters">
      <input type="text" [(ngModel)]="filterOrderId" placeholder="Order ID" />
      <select [(ngModel)]="filterStatus">
        <option value="">All Statuses</option>
        <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
      </select>
      <input type="text" [(ngModel)]="filterShopName" placeholder="Customer Name" />
      <input type="text" [(ngModel)]="filterTailorId" placeholder="Tailor ID" />
      <button (click)="applyFilters()">Apply Filters</button>
      <button (click)="clearFilters()">Clear Filters</button>
    </div>
  </div>

  <!-- Orders Table -->
  <div class="orders-table">
    <h2>My Orders</h2>
    <table>
      <thead>
      <tr>
        <th>Order ID</th>
        <th>Tailor ID</th>
        <th>Customer Name</th>
        <th>Ordered On</th>
        <th>Delivery Date</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let order of filteredOrders">
        <td>{{ order.orderId }}</td>
        <td>{{ order.tailorId !== undefined && order.tailorId !== null ? order.tailorId : 'No Tailor ID' }}</td>
        <td>{{ order.customerDetails.name || 'Loading...' }}</td>
        <td>{{ order.orderDate | date }}</td>
        <td>{{ order.deliveryDate | date }}</td>
        <td>{{ order.status}} </td>
        <td>
          <button (click)="viewOrderDetails(order)">View Details</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Order Details Popup -->
<div *ngIf="isOrderDetailsModalOpen" class="modal-overlay">
  <div class="modal">
    <button class="close-button" (click)="closeOrderDetailsModal()">&times;</button>
    <h2>Order Details</h2>

    <!-- Tracking Bar -->
    <div class="tracking-bar">
      <div class="tracking-steps">
        <div class="step" [class.active]="isStepActive('YET_TO_PICKUP')">
          <span>Yet to Pickup</span>
          <div class="circle" [class.blinking]="isStepActive('YET_TO_PICKUP')"></div>
        </div>
        <div class="step" [class.active]="isStepActive('PICKED_UP')">
          <span>Picked Up</span>
          <div class="circle" [class.blinking]="isStepActive('PICKED_UP')"></div>
        </div>
        <div class="step" [class.active]="isStepActive('IN_PROGRESS')">
          <span>In Progress</span>
          <div class="circle" [class.blinking]="isStepActive('IN_PROGRESS')"></div>
        </div>
        <div class="step" [class.active]="isStepActive('COMPLETED')">
          <span>Completed</span>
          <div class="circle" [class.blinking]="isStepActive('COMPLETED')"></div>
        </div>
        <div class="step" [class.active]="isStepActive('DELIVERED')">
          <span>Delivered</span>
          <div class="circle" [class.blinking]="isStepActive('DELIVERED')"></div>
        </div>
        <div class="step" [class.active]="isStepActive('REJECTED')">
          <span>Rejected</span>
          <div class="circle" [class.blinking]="isStepActive('REJECTED')"></div>
        </div>

        <!-- Scissors GIF Effect -->
        <div [ngClass]="{'scissors-effect': true, 'rejected': selectedOrder?.status === 'REJECTED'}"></div>

        <!-- Green/Red Line -->
        <div class="status-line" [ngClass]="{'completed': selectedOrder?.status !== 'REJECTED'}"></div>
      </div>
    </div>


    <div *ngIf="selectedOrder" class="order-details-content">
      <div class="order-info">
        <p><strong>Order ID:</strong> {{ selectedOrder.orderId }}</p>
        <p><strong>Tailor ID:</strong> {{ selectedOrder.tailorId || 'N/A' }}</p>
        <p><strong>Customer Name:</strong> {{ selectedOrder.customerDetails.name }}</p>
        <p><strong>Email:</strong> {{ selectedOrder.customerDetails.email }}</p>
        <p><strong>Phone Number:</strong> {{ selectedOrder.customerDetails.phoneNumber }}</p>
        <p><strong>Ordered On:</strong> {{ selectedOrder.orderDate | date }}</p>
        <p><strong>Delivery Date:</strong> {{ selectedOrder.deliveryDate | date }}</p>
        <p><strong>Status:</strong> {{ selectedOrder.status }}</p>
      </div>

      <!-- Measurement Details -->
      <div class="measurement-details">
        <h3>Measurement Details</h3>
        <p><strong>Gender:</strong> {{ selectedOrder.measurementDetails.gender }}</p>
        <p><strong>Category:</strong> {{ selectedOrder.measurementDetails.category }}</p>
        <p><strong>Design:</strong> {{ selectedOrder.measurementDetails.design }}</p>
        <p><strong>Measurements:</strong> {{ selectedOrder.measurementDetails.measurements }}</p>
        <p><strong>Price:</strong> â‚¹{{ selectedOrder.measurementDetails.price }}</p>
      </div>
      </div>
    </div>
  </div>


